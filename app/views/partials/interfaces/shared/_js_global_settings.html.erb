<script type="text/javascript">
  
  //if we pass this param, we clear our local data, this is mainly used in the mobile app
<% if params[:reset_local_storage] == "true" %>
    clearLocalStorageAndCookies();
<% end %>
  
  //interface
  var currentInterface = "<%= current_interface %>";
  
  //load the setting for bypass pin
  var bypassPin = <%= GlobalSetting.parsed_setting_for GlobalSetting::BYPASS_PIN %>;
    
  //clock format
  var clockFormat = "<%= GlobalSetting.parsed_setting_for GlobalSetting::CLOCK_FORMAT %>";
    
  var defaultJSDateFormat = "";
  var defaultJSTimeFormat = "";
    
  if(clockFormat == "12") {
    defaultJSDateFormat = "hh:mm dd/MM/yyyy";
    defaultJSTimeFormat = "hh:mm";
  } else {
    defaultJSDateFormat = "HH:mm dd/MM/yyyy";
    defaultJSTimeFormat = "HH:mm";
  }
  
  //is tax chargable
  var taxChargable = <%= GlobalSetting.parsed_setting_for GlobalSetting::TAX_CHARGABLE %>;
   
  var taxLabel = "<%= @tax_label %>";
   
  //global tax rate
  var globalTaxRate = <%= GlobalSetting.parsed_setting_for GlobalSetting::GLOBAL_TAX_RATE %>;
   
  //service charge label
  var serviceChargeLabel = "<%= @service_charge_label %>";
  
  //default payment method
  var defaultPaymentMethod = "<%= PaymentMethod.load_default.name %>";
   
  //load the dynamically set currency symbol
  var dynamicCurrencySymbol = "<%= @currency_symbol %>";
  
  //load the dynamically set screen that appears after a sale and login screen
  var defaultHomeScreen = <%= GlobalSetting.parsed_setting_for GlobalSetting::DEFAULT_HOME_SCREEN %>;
  var defaultPostLoginScreen = <%= GlobalSetting.parsed_setting_for GlobalSetting::DEFAULT_POST_LOGIN_SCREEN %>;
  var LOGIN_SCREEN = <%= GlobalSetting::LOGIN_SCREEN %>;
  var MENU_SCREEN = <%= GlobalSetting::MENU_SCREEN %>;
  var TABLES_SCREEN = <%= GlobalSetting::TABLES_SCREEN %>;
  
  //these variables are used for polling and they get updated by the dynamic javascript
  var lastInterfaceReloadTime = <%=Time.now.to_i%>;
  
  //this will set off a bunch of requests to fill up out table order receipts
  var lastSyncTableOrderTime = 0;
  
  //this is for the order ready notifications on mobile
  var lastOrderReadyNotificationTime = <%=Time.now.to_i%>;
  
  var autoPrintReceipt = <%= @auto_print_receipt %>;
  
  var receiptMessage = "<%= GlobalSetting.parsed_setting_for GlobalSetting::RECEIPT_MESSAGE %>";
  
  var defaultDiscountPercent = "<%=Discount.load_default.percent%>";
  
  var terminalID = "<%=@terminal_id%>";
  
  var pollingAmount = <%= (ENV['RAILS_ENV'] == 'development') ? "1000" : "2000" %>;
  
  var using_mobile = <%= mobile_device? ? "true" : "false" %>;
  
  var doBeep = <%= GlobalSetting.parsed_setting_for GlobalSetting::DO_BEEP %>;
  
  var railsEnvironment = "<%= ENV['RAILS_ENV'] %>";
  
  var kioskMode = <%= CUSTOM_CONFIG["in_kiosk_mode"] %>;
  var overrideKiosk = <%= params["override_kiosk"] or params["ok"] ? true : false %>;
  
  //business info
  var business_name = "<%= @business_name %>";
  var business_address = "<%= @business_address %>";
  var business_telephone = "<%= @business_telephone %>";
  var business_email_address = "<%= @business_email_address %>";

<% @display = Display.load_default unless @display %>
    
  var selectedDisplayId = <%= @display.id %>;
    
  var modifierGridXSize = <%=@display.order_item_addition_grid.grid_x_size%>;
  var modifierGridYSize = <%=@display.order_item_addition_grid.grid_y_size%>;
  
  //we need some button ids to mark them as selected and set permissions etsc
  var modifyOrderItemButtonID = "<%= ButtonMapper::MODIFY_ORDER_ITEM_BUTTON %>";
  var addNoteButtonID = "<%= ButtonMapper::ADD_NOTE_BUTTON %>";
  var tablesButtonID = "<%= ButtonMapper::TABLES_BUTTON %>";
  var discountButtonID = "<%= ButtonMapper::DISCOUNT_BUTTON %>";
  var changePriceButtonID = "<%= ButtonMapper::CHANGE_PRICE_BUTTON %>";
  var removeItemButtonID = "<%= ButtonMapper::REMOVE_ITEM_BUTTON %>";
  
  var updateStockType = <%= StockTransaction::STOCK_UPDATE %>;
  var transferStockType = <%= StockTransaction::STOCK_TRANSFER %>;
  
  var webSocketServiceIP = "<%= GlobalSetting.parsed_setting_for GlobalSetting::WEBSOCKET_IP, {:fingerprint => @terminal_fingerprint} %>";

  var orderReceiptWidthSetting = "<%= @order_receipt_width_setting %>";
  
  var allDevicesOrderNotification = <%= GlobalSetting.parsed_setting_for GlobalSetting::All_DEVICES_ORDER_NOTIFICATION %>;
  
  //these variables are used to get a syncronised time on each device
  var serverCounterStartTimeMillis = <%= Time.now.to_f * 1000 %>;
  var counterStartTimeMillis = new Date().getTime();
  
</script>