<% @nav_title = "Employee Import" %>

<div id="import_employees">

  <h3>Employee Import</h3>

  <section id="form_container">

    <% if @csv_validation_errors %>

      <div id="errors_container" class="jscrollpane">

        <table id="csv_error_list" class="admin_table">
          <thead>
            <tr>
              <th width="100">Line Number</th>
              <th width="300">Error Description For Line</th>
              <th width="500">Row Data</th>
            </tr>
          </thead>
          <tbody>
            <% @csv_validation_errors.each do |key, map| %>
              <tr>
                <td class="line_number">
                  CSV Line <%=key%>
                </td>
                <td>
                  <% map[:errors].each do |error_desc| %>
                    <div class="error_line">
                      <%= error_desc %>
                    </div>
                  <% end %>
                </td>
                <td>
                  <%=map[:row_data]%>
                </td>
              </tr>
            <% end %>
            </</tbody>
        </table>
      </div>

      <div class="button" id="upload_again_button" data-onpress="goTo('<%= csv_import_admin_employees_path %>');">Try Upload Again</div>

    <% else %>

      <div id="guidelines">
        <ul>
          <li>
            You can upload a CSV file to import employees to your database. 
          </li>
          <li>
            The format of the CSV file is particular to the Cluey POS system itself.
          </li>
          <li>
            Please <%= link_to "Click Here", "/files/sample_employees.csv" %> for a sample csv file that you can use. 
          </li>
          <li>
            Note that the first line of the CSV is ignored as it contains the header.
          </li>
          <li>
            The file will create categories for the ones defined in the file. 
          </li>
          <li>
            Please specify all details carefully.
          </li>
          <li>
            Make sure all employee nicknames are unique.
          </li>
          <li>
            The order of the CSV values are:
            </br>
            <b>
              STAFF_ID, NAME, NICKNAME, CLOCKIN_CODE, LOGIN_CODE, 
              ADDRESS, TELEPHONE, HOURLY_RATE, OVERTIME_RATE, ROLE
            </b>
          </li>
      </div>

      <% form_tag(csv_upload_admin_employees_path, :multipart => true) do %>
        <div id="fields">
          <div class="field">
            <label>Select CSV File</label><br/>
            <%= file_field_tag :dump_file %>
          </div>

          <div id="actions">
            <%= submit_tag "Upload", :disable_with => 'Uploading...' %>
            <%= link_to "Back", admin_employees_path %>
          </div>
        </div>
      <% end %>

    <% end %>
  </section>

</div>