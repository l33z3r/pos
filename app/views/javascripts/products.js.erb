var products = new Array();
var products_by_upc = new Array();

<% Product.all.each do |p|%>  

  var nextProduct = {
  'id':'<%= p.id %>', 'name':'<%= escape_javascript p.name %>', 
  'price':<%= p.price %>, 'tax_rate':<%=p.sales_tax_rate%>,
  'double_price' : <%=p.double_price%>,
  'hide_on_printed_receipt' : <%=p.hide_on_printed_receipt%>,
  'show_price_on_receipt' : <%=p.show_price_on_receipt%>,
  'prompt_price' : <%=p.show_price_prompt%>,
  'printers' : "<%= p.printers %>",
  'deleted' : <%= p.is_deleted %>,
  'category_id' : <%= p.category ? p.category.id : "null" %>,
  'upc' : '<%= p.upc %>',
  'code_num' : '<%= p.code_num %>',
  'modifier_grid_id' : <%= p.order_item_addition_grid ? p.order_item_addition_grid.id : "null" %>,
  'modifier_grid_id_mandatory' : <%= p.order_item_addition_grid_id_is_mandatory %>
  };

  products[<%= p.id %>] = nextProduct;

  <% if !p.upc.blank? %>
    products_by_upc[<%= p.upc %>] = nextProduct;
  <% end %>

  <% if p.modifier_category_id %>
    products[<%= p.id %>]['modifier_category_id'] = <%=p.modifier_category_id%>;
  <% end %>
<% end %>

var modifier_categories = new Array();

<% ModifierCategory.all.each do |mc| %>
  modifier_categories[<%=mc.id%>] = {'id':<%=mc.id%>, 'name':'<%= escape_javascript mc.name %>'}
  modifier_categories[<%=mc.id%>]['modifiers'] = new Array();
  <% mc.modifiers.all.each do |m| %>
    modifier_categories[<%=mc.id%>]['modifiers'][<%=m.id%>] = {'id':<%=m.id%>, 'name':'<%= escape_javascript m.name%>', 'price':<%=m.price%>}
  <% end %>
<% end %>

var categories = new Array();

<% Category.all.each do |c|%>    
  categories[<%= c.id %>] = {
  'id':'<%= c.id %>', 'name':'<%= escape_javascript c.name %>', 
  'printers': "<%= c.printers %>",
  'modifier_grid_id' : <%= c.order_item_addition_grid ? c.order_item_addition_grid.id : "null" %>,
  'modifier_grid_id_mandatory' : <%= c.order_item_addition_grid_id_is_mandatory %>, 
  'parent_category_id' : <%= c.parent_category ? c.parent_category_id : "null" %>,
  };
<% end %>