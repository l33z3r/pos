<% content_for :head do %>
  <%= javascript_include_tag "products" %>
<% end %>

<div id="menu_screen">

  <%= render "modifier_category_popups" %>

  <div id="receipt_keypad_container">

    <div id="top_buttons">
      <div id="table_select_container">
        Table:
        <select onchange="doSelectTable($(this).val())" id="table_select">
          <option data-room_id="0" value="0">None</option>
          <% Room.all.each do |room|%>
            <optgroup label="<%=room.name%>">
              <% room.table_infos.each do |table_info| %>
                <option data-room_id="<%=table_info.room_object.room.id%>"
                        value="<%= table_info.id %>"><%= table_info.perm_id %></option>
                      <% end %>
            </optgroup>
          <% end %>
        </select>
      </div>

      <div id="table_screen_button" onclick="showTablesScreen(); return false;">Tables</div>

      <div class="clear">&nbsp;</div>

      <div id="receipt_item_discount_popup_anchor">&nbsp;</div>

    </div>

    <div id="receipt">
      <div id="till_roll"></div>
      <div id="till_roll_discount"></div>
      <div id="sales_tax_total"></div>
    </div>

    <div class="clear">&nbsp;</div>

    <div id="total_container">

      <div id="label">Sub-Total:</div>
      <div id="total_value"></div>

      <div class="clear">&nbsp;</div>

    </div>

    <div id="till_keypad">
      <div id="keys">
        <% [[7,9],[4,6],[1,3]].each do |x,y| %>
          <% (x..y).each do |num| %>
            <div id="keypad_num_<%= num %>"><%= num %></div>
          <% end %>
        <% end %>

        <div id="keypad_num_0">0</div>
        <div id="decimal_key">.</div>
        <div id="cancel_key" onclick="doCancelTillKeypad()">C</div>
      </div>
    </div>
  </div>

  <div id="menu_pages_container">
    <div id="pages">
      <% @display.menu_pages.each do |page| %>
        <div class="page"  id="menu_page_<%=page.id%>"
             onclick="doMenuPageSelect(<%= page.page_num %>, <%= page.id %>);">
          <div class="name">
            <%= page.name %>
          </div>
        </div>

        <div style="display: none;" id="menu_items_<%= page.page_num %>">
          <div id="items">
            <% page.menu_items.each do |item| %>
              <% if item.product %>
                <div class="item" onclick="doSelectMenuItem(<%= item.product_id %>, this)">
                  <div class="item_pic">
                    <%= product_image_thumb item.product %>
                  </div>
                  <div class="item_name">
                    <%= item.name %>
                  </div>
                </div>
              <% end %>
            <% end %>
          </div>
        </div>

      <% end %>
    </div>

    <div class="clear">&nbsp;</div>

    <div id="menu_items_container">
      Loading...
    </div>

    <div class="clear_spacer">
      <div id="global_status_message"></div>
    </div>

    <!-- the following markup is used for the display button passcode popup -->
    <div id="menu_buttons_popup_anchor">&nbsp;</div>
    <input type="text" id="display_button_passcode" style="display: none;"/>

    <div id="menu_buttons">

      <div id="menu_buttons_loading_message">Loading Permissions...</div>

      <div style="display: none;" id="menu_buttons_panel">

      </div>
    </div>
  </div>

  <div id="edit_receipt_item_popup_markup">
    <div id="edit_receipt_item_popup_markup_container">

      <div id="header">Edit Order Item</div>

      <div id="discount_button" onclick="showDiscountPopup(this)">Discount</div>
      <div id="delete_button" onclick="removeOrderItem(this)">Delete</div>

      <div class="clear">&nbsp;</div>

      <div id="quantity_editor">

        <div id="quantity_label">Quantity:</div>
        <input type="text" class="quantity" size="2" id="current_selected_receipt_item_quantity"/>

        <div id="buttons_container">
          <div id="plus_button" onclick="editOrderItemIncreaseQuantity(this)"><div>+</div></div>
          <div id="minus_button" onclick="editOrderItemDecreaseQuantity(this)"><div>-</div></div>
        </div>
        <div class="clear">&nbsp;</div>
      </div>

      <div class="clear">&nbsp;</div>

      <div id="price_editor">
        <div class="price_label">Price Per Unit:</div>
        <input type="text" class="price" size="2" id="current_selected_receipt_item_price"/>
        <div class="clear">&nbsp;</div>
      </div>

      <div class="clear">&nbsp;</div>

      <div id="cancel_button" onclick="closeEditOrderItem()">Cancel</div>
      <div id="save_button" onclick="saveEditOrderItem(this)">Save</div>
    </div>
  </div>

  <div id="discounts_popup_markup">
    <div id="discounts_popup_markup_container">

      <div class="header">Apply Discount</div>

      <div class="clear">&nbsp;</div>

      <div class="discount_buttons">
        <% Discount.all.each do |discount| %>
          <div class="button" id="discount_button_<%=discount.id%>" onclick="setDiscountVal(<%=discount.percent%>)">
            <div class="name">
              <%=discount.name%>
            </div>
            <div class="percent">
              <%=discount.percent%>
            </div>
          </div>
        <% end %>
      </div>

      <div class="clear_top_margin_10">&nbsp;</div>

      <div id="manual_discount">
        <div class="header">Or Enter a Discount Amount</div>

        <div class="clear_top_margin_5">&nbsp;</div>

        <div class="fields">
          <div class="label">Amount:</div>
          <input type="text" class="percent" size="4" id="discount_percent_input"/>
        </div>
      </div>

      <div class="clear">&nbsp;</div>

      <div id="apply_discount_to">
        <div class="label">Apply Discount to:</div>

        <input type="radio" name="discount_type" value="whole_order" checked/>Whole Order
        <input type="radio" name="discount_type" value="last_item" checked/>Last Item
      </div>

      <div class="clear_top_margin_10">&nbsp;</div>

      <div class="actions">
        <div id="cancel_button" onclick="closeDiscountPopup()">Cancel</div>
        <div id="save_button" onclick="saveDiscount()">Save</div>
      </div>

    </div>
  </div>

  <div class="clear">&nbsp;</div>
</div>