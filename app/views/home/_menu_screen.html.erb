<% content_for :head do %>
  <%= javascript_include_tag "products", "tables" %>
<% end %>

<div id="menu_screen">

    <div id="receipt_keypad_container">

    <div id="top_buttons">
      <div id="table_select_container">
        Table:
        <select onchange="doSelectTable($(this).val())" id="table_select">
          <option data-room_id="0" value="0">None</option>
          <% Room.all.each do |room|%>
            <optgroup label="<%=room.name%>">
              <% room.table_infos.each do |table_info| %>
                <option data-room_id="<%=table_info.room_object.room.id%>"
                        value="<%= table_info.id %>"><%= table_info.perm_id %></option>
                      <% end %>
            </optgroup>
          <% end %>
        </select>
      </div>

      <div id="table_screen_button" onclick="showTablesScreen(); return false;">Tables</div>

      <div class="clear">&nbsp;</div>

      <div id="receipt_item_discount_popup_anchor">&nbsp;</div>

    </div>

    <div id="receipt" class="receipt">
      <div id="till_roll" class="till_roll"></div>
      <div id="till_roll_discount"></div>
    </div>

    <div class="clear">&nbsp;</div>

    <div id="total_container">

      <div id="label">Sub-Total:</div>
      <div id="total_value"></div>

      <div class="clear">&nbsp;</div>

    </div>

    <div id="till_keypad" class="keypad">
      <div id="keys" class="keys">
        <% [[7,9],[4,6],[1,3]].each do |x,y| %>
          <% (x..y).each do |num| %>
            <div id="keypad_num_<%= num %>" class="key" onclick="menuScreenKeypadClick(<%=num%>);"><%= num %></div>
          <% end %>
        <% end %>

        <div id="keypad_num_0" class="key" onclick="menuScreenKeypadClick(0);">0</div>
        <div id="decimal_key" class="key" onclick="menuScreenKeypadClickDecimal();">.</div>
        <div id="cancel_key" class="key" onclick="menuScreenKeypadClickCancel()">C</div>
      </div>
    </div>
  </div>

  <div id="menu_pages_container">
    <div id="pages">
      <% @display.menu_pages.each do |page| %>
        <div class="page"  id="menu_page_<%=page.id%>"
             onclick="doMenuPageSelect(<%= page.page_num %>, <%= page.id %>);">
          <div class="name">
            <%= page.name %>
          </div>
        </div>

        <div style="display: none;" id="menu_items_<%= page.page_num %>">
          <div id="items">
            <% page.menu_items.each do |item| %>
              <% if item.product %>
                <div class="item" onclick="doSelectMenuItem(<%= item.product_id %>, this)">
                  <div class="item_pic">
                    <%= product_image_thumb item.product %>
                  </div>
                  <div class="item_name">
                    <%= item.name %>
                  </div>
                </div>
              <% end %>
            <% end %>
          </div>
        </div>

      <% end %>
    </div>

    <div class="clear">&nbsp;</div>

    <div id="menu_items_container">
      Loading...
    </div>

    <div class="clear_spacer">
      <div id="menu_screen_status_message" class="global_status_message"></div>
    </div>

    <!-- the following markup is used for the display button passcode popup -->
    <div id="menu_buttons_popup_anchor">&nbsp;</div>

    <!-- the following anchor is used for the default menu screen popup -->
    <div id="menu_screen_default_popup_anchor">&nbsp;</div>

    <input type="text" id="display_button_passcode" style="display: none;"/>

    <div id="menu_buttons">

      <div id="menu_buttons_loading_message">Loading Permissions...</div>

      <div style="display: none;" id="menu_buttons_panel">

      </div>
    </div>
  </div>

  <%= render :partial => "/partials/popups_markup" %>

  <div class="clear">&nbsp;</div>
</div>

<!-- utility keypad to be called up for anything -->
<div id="util_keypad_container">
  <div id="util_keypad" class="keypad">
    <div id="util_keypad_keys" class="keys">
      <% [[7,9],[4,6],[1,3]].each do |x,y| %>
        <% (x..y).each do |num| %>
          <div id="num_<%= num %>" class="util_keypadkey" onclick="utilKeypadClick(<%=num%>)"><%= num %></div>
        <% end %>
      <% end %>

      <div class="cancel_key" class="util_keypadkey" onclick="doCancelUtilKeypad()">C</div>
      <div id="num_0" class="util_keypadkey" onclick="utilKeypadClick(0)">0</div>
      <div class="go_key" class="util_keypadkey" onclick="doGoUtilKeypad()">OK</div>
    </div>
  </div>
</div>

<!-- iframe to print in -->
<iframe name="printFrame" id="printFrame" width="0" frameborder="0" height="0" src="<%= blank_receipt_for_print_path %>"></iframe>