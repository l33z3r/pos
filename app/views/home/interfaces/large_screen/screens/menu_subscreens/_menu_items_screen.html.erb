<%#TODO: NEED TO CACHE BASED OFF THE TERMINAL ID SOMEHOW, OR FINGERPRINT%>
<%# cache("menu_items_screen") do %>

  <div id="menu_container">
    <div id="pages">
      <% @display.menu_pages.each do |page| %>
        <div class="page" id="menu_page_<%=page.id%>"
             onclick="doMenuPageSelect(<%= page.page_num %>, <%= page.id %>);">
          <div class="name">
            <%= page.name %>
          </div>
        </div>

        <div style="display: none;" id="menu_items_<%= page.page_num %>">
          <div id="items">
            <% page.menu_items.each do |item| %>
              <% if item.product %>
                <div class="item <%= !item.product.is_active ? "inactive" : "" %>" 
                     data-button_width="<%= item.product.menu_button_width %>" 
                     data-menu_item_id="<%= item.id %>"
                     onclick="<%= item.product.is_active ? "doSelectMenuItem(#{item.product_id}, #{item.id}, this);" : "" %>"
                     style="<%= menu_item_background_css item %>">
                  
                  <div class="stock_count" style="display: none;" id="stock_count_<%= item.id %>"></div>
                  <div class="price_change" style="display: none;" id="price_change_<%= item.id %>"></div>
                  
                  <div class="item_pic">
                    <%= product_image_thumb item.product if item.product.show_button_image %>
                  </div>
                  <div class="item_name" style="<%= menu_item_background_css item %><%= item.product.button_text_color.blank? ? "" : "color: #{item.product.button_text_color};" %>">
                    <%= menu_item_name item %>
                  </div>
                </div>
              <% end %>
            <% end %>
          </div>
        </div>

      <% end %>
    </div>

    <div class="clear">&nbsp;</div>

    <div id="menu_items_container">
      Loading...
    </div>
  </div>

<%# end %>